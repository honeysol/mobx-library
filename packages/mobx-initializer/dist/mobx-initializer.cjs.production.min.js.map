{"version":3,"file":"mobx-initializer.cjs.production.min.js","sources":["../src/util.ts","../src/index.ts"],"sourcesContent":["export const applyHandler = (target, handlersName, ...args) => {\n  const handlersPropertyName = \"_\" + handlersName + \"Handler\";\n  for (\n    let current = target;\n    current;\n    current = Object.getPrototypeOf(current)\n  ) {\n    if (current.hasOwnProperty(handlersPropertyName)) {\n      for (const handler of current[handlersPropertyName] || []) {\n        handler.apply(target, args);\n      }\n    }\n  }\n};\n\nexport const applyHandlerOnce = (target, handlersName, ...args) => {\n  const handlersPropertyName = \"_\" + handlersName + \"Handler\";\n  const flagPropetyName = handlersPropertyName + \"Done\";\n  if (target[flagPropetyName]) {\n    return;\n  }\n  target[flagPropetyName] = true;\n  applyHandler(target, handlersName, ...args);\n};\n\nexport const addHandler = (target, handlersName, handler) => {\n  const handlersPropertyName = \"_\" + handlersName + \"Handler\";\n  if (!target.hasOwnProperty(handlersPropertyName)) {\n    target[handlersPropertyName] = [];\n  }\n  target[handlersPropertyName].push(handler);\n};\n\nconst _combineDecorator = (...decorators) => {\n  return (_target, fieldName, _descriptor) => {\n    if (fieldName) {\n      if (typeof fieldName !== \"string\") {\n        console.error(_target, fieldName, _descriptor, decorators);\n        debugger;\n      }\n      const target = _target;\n      let descriptor = _descriptor;\n      for (const decorator of decorators) {\n        descriptor = decorator(target, fieldName, descriptor) || descriptor;\n      }\n      return descriptor === _descriptor ? null : descriptor;\n    } else {\n      let target = _target;\n      for (const decorator of decorators) {\n        target = decorator(target) || target;\n      }\n      return target === _target ? null : target;\n    }\n  };\n};\n\nexport const combineDecorator = (...decorators) => {\n  return (target, ...args) => {\n    if (\n      target.hasOwnProperty(\"constructor\") ||\n      target.hasOwnProperty(\"prototype\")\n    ) {\n      const [ fieldName, descriptor] = args;\n      return _combineDecorator(\n        ...decorators.map(decorator =>\n          decorator[isAcceptable] ? decorator.decorator : decorator\n        )\n      )(target, fieldName, descriptor);\n    } else {\n      return _combineDecorator(\n        ...decorators.map(decorator =>\n          decorator[isAcceptable]\n            ? decorator.decorator(target, ...args)\n            : decorator\n        )\n      );\n    }\n  };\n};\n\nexport const parametrizeDecorator = (decorator, defaultValue) => {\n  return (target, ...args) => {\n    if (\n      target.hasOwnProperty(\"constructor\") ||\n      target.hasOwnProperty(\"prototype\")\n    ) {\n      // パラメータがない時\n      return decorator(defaultValue(target, ...args))(target, ...args);\n    } else {\n      // パラメータが与えられた時\n      return decorator(target, ...args);\n    }\n  };\n};\n\nconst isAcceptable = Symbol(\"isAcceptable\");\n\nexport const acceptParams = decorator => ({\n  decorator,\n  [isAcceptable]: true,\n});\n","import { applyHandlerOnce } from \"./util\";\nexport * from \"./util\";\n\nconst appliedFlag = Symbol(\"isAppliedMobxInitializer\");\n\nexport const initializer = (target, ...args) => {\n  if (target.prototype[appliedFlag]) {\n    return target;\n  }\n  return class initializer extends target {\n    [appliedFlag] = true;\n    constructor(props) {\n      super(props);\n      applyHandlerOnce(this, \"init\", props);\n    }\n  };\n};\n\n"],"names":["applyHandler","target","handlersName","handlersPropertyName","args","current","Object","getPrototypeOf","hasOwnProperty","handler","apply","applyHandlerOnce","flagPropetyName","_combineDecorator","decorators","_target","fieldName","_descriptor","console","error","descriptor","decorator","isAcceptable","Symbol","appliedFlag","push","map","prototype","props","defaultValue"],"mappings":"u4BAAaA,EAAe,SAACC,EAAQC,WAC7BC,EAAuB,IAAMD,EAAe,6BADEE,mCAAAA,wBAGlD,IAAIC,EAAUJ,EACdI,EACAA,EAAUC,OAAOC,eAAeF,MAE5BA,EAAQG,eAAeL,iBACHE,EAAQF,IAAyB,mBAAI,KAAhDM,UACTA,EAAQC,MAAMT,EAAQG,KAMjBO,EAAmB,SAACV,EAAQC,OACjCC,EAAuB,IAAMD,EAAe,UAC5CU,EAAkBT,EAAuB,WAC3CF,EAAOW,IAGXX,EAAOW,IAAmB,6BAN8BR,mCAAAA,oBAOxDJ,gBAAaC,EAAQC,UAAiBE,MAWlCS,EAAoB,sCAAIC,2BAAAA,yBACrB,SAACC,EAASC,EAAWC,MACtBD,EAAW,CACY,iBAAdA,GACTE,QAAQC,MAAMJ,EAASC,EAAWC,EAAaH,aAG3Cb,EAASc,EACXK,EAAaH,MACOH,kBACtBM,GAAaC,WAAUpB,EAAQe,EAAWI,IAAeA,SAEpDA,IAAeH,EAAc,KAAOG,YAEvCnB,EAASc,MACWD,kBACtBb,GAASoB,WAAUpB,IAAWA,SAEzBA,IAAWc,EAAU,KAAOd,IA4CnCqB,EAAeC,OAAO,gBC5FtBC,EAAcD,OAAO,iDD8FC,SAAAF,mBAC1BA,UAAAA,IACCC,IAAe,wBA1EQ,SAACrB,EAAQC,EAAcO,OACzCN,EAAuB,IAAMD,EAAe,UAC7CD,EAAOO,eAAeL,KACzBF,EAAOE,GAAwB,IAEjCF,EAAOE,GAAsBsB,KAAKhB,+EA0BJ,sCAAIK,2BAAAA,yBAC3B,SAACb,8BAAWG,mCAAAA,uBAEfH,EAAOO,eAAe,gBACtBP,EAAOO,eAAe,aACtB,KACQQ,EAAyBZ,KAAdgB,EAAchB,YAC1BS,eACFC,EAAWY,KAAI,SAAAL,UAChBA,EAAUC,GAAgBD,EAAUA,UAAYA,KAF7CR,CAILZ,EAAQe,EAAWI,UAEdP,eACFC,EAAWY,KAAI,SAAAL,UAChBA,EAAUC,GACND,EAAUA,gBAAVA,GAAoBpB,UAAWG,IAC/BiB,4BCpEa,SAACpB,kBACtBA,EAAO0B,UAAUH,GACZvB,oCAIK2B,8BACJA,cAFQ,EAGdjB,+HAAuB,OAAQiB,sGAJF3B,KAC9BuB,mCDsE+B,SAACH,EAAWQ,UACvC,SAAC5B,8BAAWG,mCAAAA,2BAEfH,EAAOO,eAAe,gBACtBP,EAAOO,eAAe,aAGfa,EAAUQ,gBAAa5B,UAAWG,mBAAOH,UAAWG,IAGpDiB,gBAAUpB,UAAWG"}
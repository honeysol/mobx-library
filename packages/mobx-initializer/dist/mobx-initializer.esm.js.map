{"version":3,"file":"mobx-initializer.esm.js","sources":["../src/class.ts","../src/method.ts","../src/property.ts","../src/index.ts"],"sourcesContent":["export type ClassType<T> = new (...args: any[]) => T;\nexport type ClassDecorator<T> = (\n  target: ClassType<T>\n) => ClassType<T> | undefined;\n\nexport const combineClassDecorator = <T>(\n  ...decorators: ClassDecorator<T>[]\n): ClassDecorator<T> => {\n  return ((target: ClassType<T>) => {\n    let current = target;\n    for (const decorator of decorators) {\n      current = decorator(current) || current;\n    }\n    return current === target ? undefined : current;\n  }) as ClassDecorator<T>;\n};\n","export const combineMethodDecorator = (\n  ...decorators: MethodDecorator[]\n): MethodDecorator => {\n  return (\n    _target: object,\n    fieldName: string | symbol,\n    _descriptor: PropertyDescriptor\n  ) => {\n    const target = _target;\n    let descriptor = _descriptor;\n    for (const decorator of decorators) {\n      descriptor = decorator(target, fieldName, descriptor) || descriptor;\n    }\n    //return descriptor === _descriptor ? undefined : descriptor;\n  };\n};\n\nconst isClass = (target: any) => {\n  return (\n    typeof target === \"object\" &&\n    Object.prototype.hasOwnProperty.call(target, \"constructor\")\n  );\n};\nexport type MethodDecoratorGenerator<A> = (params: A) => MethodDecorator;\nexport type MethodDecoratorOptionalGenerator<A> = MethodDecoratorGenerator<A> &\n  MethodDecorator;\n\nexport const parametrizeMethodDecorator = <T, S>(\n  decoratorFactory: MethodDecoratorGenerator<S>,\n  defaultValue: (\n    target: T,\n    fieldName: string,\n    descriptor: PropertyDescriptor\n  ) => S\n): MethodDecoratorOptionalGenerator<S> => {\n  return (((...args: any[]) => {\n    if (isClass(args[0])) {\n      // without parameter\n      const [target, fieldName, descriptor] = args as [\n        T,\n        string,\n        PropertyDescriptor\n      ];\n      return decoratorFactory(defaultValue(target, fieldName, descriptor))(\n        target,\n        fieldName,\n        descriptor\n      );\n    } else {\n      // with parameter\n      const [params] = args as [S];\n      return decoratorFactory(params);\n    }\n  }) as unknown) as MethodDecoratorOptionalGenerator<S>;\n};\n","export const combinePropertyDecorator = (\n  ...decorators: PropertyDecorator[]\n): PropertyDecorator => {\n  return (\n    _target: object,\n    fieldName: string | symbol,\n    descriptor?: PropertyDescriptor\n  ) => {\n    const target = _target;\n    for (const decorator of decorators) {\n      (decorator as any)(target, fieldName, descriptor);\n    }\n    //return descriptor === _descriptor ? undefined : descriptor;\n  };\n};\n\nconst isClass = (target: any) => {\n  return (\n    typeof target === \"object\" &&\n    Object.prototype.hasOwnProperty.call(target, \"constructor\")\n  );\n};\n\nexport type PropertyDecoratorGenerator<A> = (params: A) => PropertyDecorator;\nexport type PropertyDecoratorOptionalGenerator<A> = PropertyDecoratorGenerator<\n  A\n> &\n  PropertyDecorator;\n\nexport const parametrizePropertyDecorator = <T, S>(\n  decoratorGenerator: PropertyDecoratorGenerator<S>,\n  defaultValue: (\n    target: T,\n    fieldName: string,\n    descriptor: PropertyDescriptor\n  ) => S\n): PropertyDecoratorOptionalGenerator<S> => {\n  return (((...args: any[]) => {\n    if (isClass(args[0])) {\n      // without parameter\n      const [target, fieldName, descriptor] = args as [\n        T,\n        string,\n        PropertyDescriptor\n      ];\n      return decoratorGenerator(defaultValue(target, fieldName, descriptor))(\n        target,\n        fieldName\n      );\n    } else {\n      // with parameter\n      const [params] = args as [S];\n      return decoratorGenerator(params);\n    }\n  }) as unknown) as PropertyDecoratorOptionalGenerator<S>;\n};\n","export * from \"./class\";\nexport * from \"./method\";\nexport * from \"./property\";\n\nexport const applyHandler = <T>(\n  target: any,\n  handlersName: string,\n  ...args: any\n) => {\n  const handlersPropertyName = \"_\" + handlersName + \"Handler\";\n  const flagPropetyName = handlersPropertyName + \"Done\";\n  if (target[flagPropetyName]) {\n    return;\n  }\n  target[flagPropetyName] = true;\n  for (\n    let current = target;\n    current;\n    current = Object.getPrototypeOf(current)\n  ) {\n    if (Object.prototype.hasOwnProperty.call(current, handlersPropertyName)) {\n      for (const handler of current[handlersPropertyName] || []) {\n        handler.apply(target, args);\n      }\n    }\n  }\n};\n\nexport const addHandler = (target: any, handlersName: string, handler: any) => {\n  const handlersPropertyName = \"_\" + handlersName + \"Handler\";\n  if (!Object.prototype.hasOwnProperty.call(target, handlersPropertyName)) {\n    target[handlersPropertyName] = [];\n  }\n  target[handlersPropertyName].push(handler);\n};\n"],"names":["combineClassDecorator","decorators","target","current","decorator","undefined","combineMethodDecorator","_target","fieldName","_descriptor","descriptor","isClass","Object","prototype","hasOwnProperty","call","parametrizeMethodDecorator","decoratorFactory","defaultValue","args","params","combinePropertyDecorator","parametrizePropertyDecorator","decoratorGenerator","applyHandler","handlersName","handlersPropertyName","flagPropetyName","getPrototypeOf","handler","apply","addHandler","push"],"mappings":"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"}
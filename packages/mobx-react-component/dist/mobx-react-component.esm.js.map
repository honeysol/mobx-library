{"version":3,"file":"mobx-react-component.esm.js","sources":["../src/component.ts","../src/intercept.ts","../src/prop.ts","../src/state.ts","../src/render.ts","../src/resource.ts","../src/watch.ts"],"sourcesContent":["import { observable } from \"mobx\";\nimport {\n  initializer,\n  applyHandlerOnce,\n  combineDecorator,\n} from \"mobx-initializer\";\n\nconst componentAppliedFlag = Symbol(\"isAppliedMobxReactComponentInitializer\");\nconst pureComponentAppliedFlag = Symbol(\n  \"isAppliedMobxReactPureComponentInitializer\"\n);\n\nexport const componentStatus = Symbol(\"componentStatus\");\n\ninterface MobXComponent extends React.Component{\n  componentStatus?: \"mounted\";\n}\n\nconst _component = (target: new (...args:any[]) => MobXComponent) => {\n  if (target.prototype[componentAppliedFlag]) {\n    return target;\n  }\n  class component extends target {\n    [componentAppliedFlag] = true;\n    [componentStatus]?: string;\n    @observable.ref\n    props;\n    constructor(props) {\n      super(props);\n      applyHandlerOnce(this, \"stateRegister\", props);\n      applyHandlerOnce(this, \"resourceRegister\", props);\n    }\n    componentDidMount() {\n      super.componentDidMount?.call(this);\n      this[componentStatus] = \"mounted\";\n    }\n    componentWillUnmount() {\n      super.componentWillUnmount?.call(this);\n      applyHandlerOnce(this, \"release\");\n    }\n  };\n  return component;\n};\n\n// pure componentでは、propの変更があってもstateの変更がない限り、renderされない\n\nconst _pureComponent = target => {\n  if (target.prototype[pureComponentAppliedFlag]) {\n    return target;\n  }\n  return class component extends target {\n    [pureComponentAppliedFlag] = true;\n    shouldComponentUpdate(nextProps: any, nextState: any) {\n      return nextState !== this.state;\n    }\n  };\n};\n\nexport const component:any = combineDecorator(initializer, _component);\n\ncomponent.pure = combineDecorator(initializer, _component, _pureComponent);\n","import { intercept as mobxIntercept, computed } from \"mobx\";\nimport { addHandler, parametrizeDecorator } from \"mobx-initializer\";\nimport _ from \"lodash\";\n\nexport const _intercept = handler => (target, fieldName, descriptor) => {\n  console.log(\"_intercept\", descriptor);\n  const cancelObserveFieldname = Symbol(\"cancelObserveFieldname: \" + fieldName);\n  addHandler(target, \"stateRegister\", function(props) {\n    this[cancelObserveFieldname] = mobxIntercept(\n      this,\n      fieldName,\n      handler.bind(this)\n    );\n  });\n  addHandler(target, \"release\", function(props) {\n    this[cancelObserveFieldname]();\n  });\n  return descriptor;\n};\n\nexport const intercept:any = parametrizeDecorator(_intercept, () => null);\n\nintercept.computed = handler => (target, fieldName, descriptor) => {\n  const temporaryFieldName = Symbol(\"temporaryFieldName: \" + fieldName);\n  return computed(target, fieldName, {\n    get() {\n      const newValue = descriptor.get.apply(this);\n      const oldValue = this[temporaryFieldName];\n      if (handler.call(this, { newValue, oldValue })) {\n        this[temporaryFieldName] = newValue;\n      }\n      return this[temporaryFieldName];\n    },\n  });\n};\n\nintercept.isEqual = intercept.computed(\n  ({ newValue, oldValue }) => !_.isEqual(newValue, oldValue)\n);\n","import { computed } from \"mobx\";\nimport { parametrizeDecorator } from \"mobx-initializer\";\nimport { intercept } from \"./intercept\";\n\n// example:\n// fieldIdentifierToFunc(\"foo.bar\")({ foo: { bar: 123} }) === 123\nconst fieldIdentifierToFunc = fieldIdentifier => {\n  const exp = fieldIdentifier\n    .split(\".\")\n    .map(field => `(a=a[${JSON.stringify(field)}])`)\n    .join(\"&&\");\n  return eval(`(function(a){return ${exp};})`);\n};\n\nconst createPropDecorator = computedFunc =>\n  parametrizeDecorator(\n    propName => (target, fieldName, descriptor) => {\n      const getter = fieldIdentifierToFunc(propName);\n      return computedFunc(target, fieldName, {\n        get: function() {\n          return getter(this.props);\n        },\n      });\n    },\n    (target, fieldName) => fieldName\n  );\n\nexport const prop:any = createPropDecorator(computed);\n\nprop.deep = createPropDecorator(intercept.isEqual);\n\nconst propDelegateDecorator = parametrizeDecorator(\n  propName => (target, fieldName, descriptor) => {\n    return {\n      get() {\n        return (...args) => {\n          this.props[propName](...args);\n        };\n      },\n    };\n  },\n  (target, fieldName) => fieldName\n);\n\nprop.delegate = propDelegateDecorator;\n","import { observe, observable, computed } from \"mobx\";\nimport {\n  addHandler,\n  combineDecorator,\n} from \"mobx-initializer\";\nimport {  componentStatus } from \"./component\";\n\nconst _state = (target, fieldName, descriptor) => {\n  const cancelObserveFieldname = Symbol(\"_observe_\" + fieldName);\n\n  addHandler(target, \"stateRegister\", function(props) {\n    this[cancelObserveFieldname] = observe(this, fieldName, () => {\n      if (this[componentStatus] === \"mounted\") {\n        this.setState({ [fieldName]: this[fieldName] });\n      }\n    });\n    this.state = this.state || { dammy: \"###\" };\n    this.state[fieldName] = this[fieldName];\n  });\n  addHandler(target, \"release\", function(props) {\n    this[cancelObserveFieldname]();\n  });\n  return descriptor;\n};\n\nexport const state: any = _state;\n\nstate.computed = combineDecorator(computed, _state);\nstate.computed.struct = combineDecorator(computed.struct, _state);\nstate.observable = combineDecorator(observable.ref, _state);\nstate.deep = combineDecorator(observable.deep, _state);\nstate.shallow = combineDecorator(observable.shallow, _state);\nstate.ref = combineDecorator(observable.ref, _state);\nstate.struct = combineDecorator(observable.struct, _state);\n","import { addHandler, combineDecorator } from \"mobx-initializer\";\nimport { state } from \"./state\";\nimport * as crypto from \"crypto\";\n\n// エラーの原因: combineDecoratorの扱いがおかしい\n\nconst _render = (target, fieldName, descriptor) => {\n  if (fieldName === \"render\") {\n    const fieldId = fieldName + crypto.randomBytes(8).toString(\"hex\");\n    Object.defineProperty(\n      target,\n      fieldId,\n      state.computed(target, fieldId, descriptor)\n    );\n    return {\n      configurable: true,\n      value() {\n        return this[fieldId];\n      },\n    };\n  } else {\n    addHandler(target, \"init\", function(props) {\n      this.render = function() {\n        return this[fieldName];\n      };\n    });\n    return state.computed(target, fieldName, descriptor);\n  }\n};\n\nexport const render = _render;\n","import { observe, computed, observable } from \"mobx\";\nimport { addHandler } from \"mobx-initializer\";\n\nconst defaultHandler = value => value;\n\n// Example:\n// @resource({\n// \ton: (resource, handler) => resource.on(\"update\", handler),\n// \toff: (resource, handler) => resource.off(\"update\", handler),\n// \thandler: value => value, // or event => event.value\n// \tresourceFieldName: \"documentResource\"\n// })\n// @observable\n// document\n\nexport const resource = ({\n  on,\n  off,\n  handler = defaultHandler,\n  resourceFieldName,\n}) => (target, fieldName, descriptor) => {\n  const wrappedHandlerFieldName = Symbol(\"_\" + fieldName + \"Handler\");\n  const cancelObserveFieldname = Symbol(\"_resource_\" + fieldName);\n\n  addHandler(target, \"init\", function() {\n    this[wrappedHandlerFieldName] = (...args) => {\n      this[fieldName] = handler.apply(this, args);\n    };\n    this[cancelObserveFieldname] = observe(\n      this,\n      resourceFieldName,\n      change => {\n        const { oldValue, newValue } = change;\n        if (oldValue) {\n          off(oldValue, this[wrappedHandlerFieldName]);\n        }\n        if (newValue) {\n          on(newValue, this[wrappedHandlerFieldName]);\n        }\n      },\n      true\n    );\n  });\n  addHandler(target, \"release\", function() {\n    if (this[resourceFieldName]) {\n      off(this[resourceFieldName], this[wrappedHandlerFieldName]);\n    }\n    this[cancelObserveFieldname]();\n  });\n};\n\nresource.computed = ({ on, off, handler = defaultHandler }) => (\n  target,\n  resolvedFieldName,\n  descriptor\n) => {\n  // resource\n  const resourceFieldName = resolvedFieldName + \"Resource\";\n  Object.defineProperty(target, resourceFieldName, descriptor);\n  computed(target, resourceFieldName, descriptor);\n\n  // resolved\n  delete target[resolvedFieldName];\n  return resource({ on, off, handler, resourceFieldName })(\n    target,\n    resolvedFieldName,\n    observable.ref(target, resolvedFieldName, {\n      configurable: true,\n      writable: true,\n      value: null,\n    })\n  );\n};\n","import { observe } from \"mobx\";\nimport { addHandler, parametrizeDecorator } from \"mobx-initializer\";\n\nexport const _watch = watchFieldName => (target, fieldName, descriptor) => {\n  if (!descriptor.value) {\n    console.error(\"decorator errsor\", watchFieldName, fieldName, descriptor);\n  }\n  if (fieldName) {\n    const cancelObserveFieldname = Symbol(\n      \"cancelObserveFieldname: \" + fieldName\n    );\n    addHandler(target, \"stateRegister\", function(props) {\n      this[cancelObserveFieldname] = observe(\n        this,\n        watchFieldName,\n        descriptor.value.bind(this),\n        true\n      );\n    });\n    addHandler(target, \"release\", function(props) {\n      this[cancelObserveFieldname]();\n    });\n  } else {\n    const cancelObserveFieldname = Symbol(\"cancelObserveFieldname\");\n    addHandler(target, \"stateRegister\", function(props) {\n      this[cancelObserveFieldname] = observe(\n        watchFieldName,\n        descriptor.value.bind(this)\n      );\n    });\n    addHandler(target, \"release\", function(props) {\n      this[cancelObserveFieldname]();\n    });\n  }\n};\n\nexport const watch = parametrizeDecorator(_watch, () => null);\n"],"names":["componentAppliedFlag","Symbol","pureComponentAppliedFlag","componentStatus","_component","target","prototype","component","props","applyHandlerOnce","componentDidMount","call","componentWillUnmount","__decorate","observable","ref","_pureComponent","shouldComponentUpdate","nextProps","nextState","state","combineDecorator","initializer","pure","_intercept","handler","fieldName","descriptor","console","log","cancelObserveFieldname","addHandler","mobxIntercept","bind","intercept","parametrizeDecorator","computed","temporaryFieldName","get","newValue","apply","oldValue","isEqual","_","fieldIdentifierToFunc","fieldIdentifier","exp","split","map","field","JSON","stringify","join","eval","createPropDecorator","computedFunc","propName","getter","prop","deep","propDelegateDecorator","delegate","_state","observe","setState","dammy","struct","shallow","_render","fieldId","crypto","toString","Object","defineProperty","configurable","value","render","defaultHandler","resource","on","off","resourceFieldName","wrappedHandlerFieldName","args","change","resolvedFieldName","writable","_watch","watchFieldName","error","watch"],"mappings":"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"}
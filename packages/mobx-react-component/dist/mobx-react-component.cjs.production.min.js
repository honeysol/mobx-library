"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var tslib=require("tslib"),mobx=require("mobx"),mobxInitializer=require("mobx-initializer"),isEqual=_interopDefault(require("lodash.isequal")),crypto=require("crypto");function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var componentAppliedFlag=Symbol("isAppliedMobxReactComponentInitializer"),pureComponentAppliedFlag=Symbol("isAppliedMobxReactPureComponentInitializer"),componentStatus=Symbol("componentStatus"),_component=function(e){var t;if(e.prototype[componentAppliedFlag])return e;var r=function(e){function r(r){var o;return(o=e.call(this,r)||this)[t]=!0,mobxInitializer.applyHandler(_assertThisInitialized(o),"init",r),mobxInitializer.applyHandler(_assertThisInitialized(o),"stateRegister",r),mobxInitializer.applyHandler(_assertThisInitialized(o),"resourceRegister",r),o}_inheritsLoose(r,e);var o=r.prototype;return o.componentDidMount=function(){var t;null==(t=e.prototype.componentDidMount)||t.call(this),this[componentStatus]="mounted"},o.componentWillUnmount=function(){var t;null==(t=e.prototype.componentWillUnmount)||t.call(this),mobxInitializer.applyHandler(this,"release")},r}(e);return t=componentAppliedFlag,tslib.__decorate([mobx.observable.ref,tslib.__metadata("design:type",Object)],r.prototype,"props",void 0),r},_pureComponent=function(e){var t,r;return e.prototype[pureComponentAppliedFlag]?e:(r=function(e){function r(){var r;return(r=e.apply(this,arguments)||this)[t]=!0,r}return _inheritsLoose(r,e),r.prototype.shouldComponentUpdate=function(e,t){return t!==this.state},r}(e),t=pureComponentAppliedFlag,r)},component=_component;component.pure=mobxInitializer.combineClassDecorator(_component,_pureComponent);var _intercept=function(e){return function(t,r,o){var n=Symbol("cancelObserveFieldname: "+r.toString());return mobxInitializer.addHandler(t,"stateRegister",(function(){this[n]=mobx.intercept(this,r,e.bind(this))})),mobxInitializer.addHandler(t,"release",(function(){this[n]()})),o}},intercept=_intercept;intercept.computed=function(e){return function(t,r,o){var n=Symbol("temporaryFieldName: "+r.toString());return mobx.computed(t,r,{get:function(){var t,r=null==(t=o.get)?void 0:t.apply(this);return e.call(this,{newValue:r,oldValue:this[n]})&&(this[n]=r),this[n]}})}},intercept.isEqual=intercept.computed((function(e){return!isEqual(e.newValue,e.oldValue)}));var fieldIdentifierToFunc=function fieldIdentifierToFunc(fieldIdentifier){var exp=fieldIdentifier.split(".").map((function(e){return"(a=a["+JSON.stringify(e)+"])"})).join("&&");return eval("(function(a){return "+exp+";})")},createPropDecorator=function(e){return mobxInitializer.parametrizePropertyDecorator((function(t){return function(r,o){var n=fieldIdentifierToFunc(t);e(r,o,{get:function(){return n(this.props)}})}}),(function(e,t){return t}))},prop=createPropDecorator(mobx.computed);prop.deep=createPropDecorator(intercept.isEqual),prop.delegate=mobxInitializer.parametrizePropertyDecorator((function(e){return function(t,r){return{get:function(){var t=this;return function(){var r;(r=t.props)[e].apply(r,arguments)}}}}}),(function(e,t){return t}));var _state=function(e,t){var r=Symbol("_observe_"+t);mobxInitializer.addHandler(e,"stateRegister",(function(){var e=this;this[r]=mobx.observe(this,t,(function(){var r;"mounted"===e[componentStatus]&&e.setState(((r={})[t]=e[t],r))})),this.state=this.state||{dammy:"###"},this.state[t]=this[t]})),mobxInitializer.addHandler(e,"release",(function(){this[r]()}))},state=_state;state.computed=mobxInitializer.combinePropertyDecorator(mobx.computed,_state),state.computed.struct=mobxInitializer.combinePropertyDecorator(mobx.computed.struct,_state),state.observable=mobxInitializer.combinePropertyDecorator(mobx.observable.ref,_state),state.deep=mobxInitializer.combinePropertyDecorator(mobx.observable.deep,_state),state.shallow=mobxInitializer.combinePropertyDecorator(mobx.observable.shallow,_state),state.ref=mobxInitializer.combinePropertyDecorator(mobx.observable.ref,_state),state.struct=mobxInitializer.combinePropertyDecorator(mobx.observable.struct,_state);var X=function(){this.x=0};tslib.__decorate([state,tslib.__metadata("design:type",Object)],X.prototype,"x",void 0);var render=function(e,t,r){if("render"===t){var o=t+crypto.randomBytes(8).toString("hex");return state.computed(e,o,{get:r.value}),{configurable:!0,value:function(){return this[o]}}}state.computed(e,t,{get:r.get||r.value}),Object.defineProperty(e,"render",{value:function(){return this[t]}})},defaultHandler=function(e){return e},resource=function(e){var t=e.on,r=e.off,o=e.handler,n=void 0===o?defaultHandler:o,i=e.resourceFieldName;return function(e,o,a){var l=Symbol("_"+o+"Handler"),s=Symbol("_resource_"+o);mobxInitializer.addHandler(e,"init",(function(){var e=this;this[l]=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e[o]=n.apply(e,r)},this[s]=mobx.observe(this,i,(function(o){var n=o.oldValue,i=o.newValue;n&&r(n,e[l]),i&&t(i,e[l])}),!0)})),mobxInitializer.addHandler(e,"release",(function(){this[i]&&r(this[i],this[l]),this[s]()}))}};resource.computed=function(e){var t=e.on,r=e.off,o=e.handler,n=void 0===o?defaultHandler:o;return function(e,o,i){var a=o+"Resource";return Object.defineProperty(e,a,i),mobx.computed(e,a,i),delete e[o],resource({on:t,off:r,handler:n,resourceFieldName:a})(e,o,mobx.observable.ref(e,o,{configurable:!0,writable:!0,value:null}))}};var watch=function(e){return function(t,r,o){if(o.value||console.error("decorator error",e,r,o),r){var n=Symbol("cancelObserveFieldname: "+r);mobxInitializer.addHandler(t,"stateRegister",(function(){this[n]=mobx.observe(this,e,o.value.bind(this),!0)})),mobxInitializer.addHandler(t,"release",(function(){this[n]()}))}else{var i=Symbol("cancelObserveFieldname");mobxInitializer.addHandler(t,"stateRegister",(function(){this[i]=mobx.observe(e,o.value.bind(this))})),mobxInitializer.addHandler(t,"release",(function(){this[i]()}))}}};exports.component=component,exports.intercept=intercept,exports.prop=prop,exports.render=render,exports.resource=resource,exports.state=state,exports.watch=watch;
//# sourceMappingURL=mobx-react-component.cjs.production.min.js.map
